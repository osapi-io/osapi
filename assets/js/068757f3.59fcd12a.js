"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9251],{23874(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var o=t(74848),i=t(28453);const s={title:"Client SDK for programmatic automation",status:"done",created:new Date("2026-02-22T00:00:00.000Z"),updated:new Date("2026-02-25T00:00:00.000Z")},a=void 0,r={id:"sidebar/development/tasks/done/2026-02-22-feat-client-sdk",title:"Client SDK for programmatic automation",description:"Outcome",source:"@site/docs/sidebar/development/tasks/done/2026-02-22-feat-client-sdk.md",sourceDirName:"sidebar/development/tasks/done",slug:"/sidebar/development/tasks/done/2026-02-22-feat-client-sdk",permalink:"/osapi/sidebar/development/tasks/done/2026-02-22-feat-client-sdk",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Client SDK for programmatic automation",status:"done",created:"2026-02-22T00:00:00.000Z",updated:"2026-02-25T00:00:00.000Z"},sidebar:"testSidebar",previous:{title:"Fix trace context propagation from API server to worker via NATS",permalink:"/osapi/sidebar/development/tasks/done/2026-02-21-fix-trace-propagation"},next:{title:"Add `changed` field to mutation responses",permalink:"/osapi/sidebar/development/tasks/done/2026-02-25-add-changed-field-to-mutation-responses"}},l={},d=[{value:"Outcome",id:"outcome",level:2},{value:"Objective",id:"objective",level:2},{value:"Motivation",id:"motivation",level:2},{value:"Design Considerations",id:"design-considerations",level:2},{value:"Example Usage",id:"example-usage",level:2},{value:"Notes",id:"notes",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"outcome",children:"Outcome"}),"\n",(0,o.jsxs)(n.p,{children:["Created ",(0,o.jsx)(n.code,{children:"osapi-sdk"})," as a separate sibling repo with generated HTTP client,\nservice wrappers (",(0,o.jsx)(n.code,{children:"Command"}),", ",(0,o.jsx)(n.code,{children:"Network"}),", ",(0,o.jsx)(n.code,{children:"Health"}),", ",(0,o.jsx)(n.code,{children:"Job"}),", ",(0,o.jsx)(n.code,{children:"Audit"}),", ",(0,o.jsx)(n.code,{children:"System"}),",\n",(0,o.jsx)(n.code,{children:"Metrics"}),"), and connection management. Migrated all CLI commands from\n",(0,o.jsx)(n.code,{children:"internal/client/"})," to the SDK and deleted the internal package entirely.\nDeclarative engine/playbook support tracked in\n",(0,o.jsx)(n.a,{href:"/osapi/sidebar/development/tasks/backlog/2026-02-25-feat-declarative-playbook-engine",children:"backlog"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"objective",children:"Objective"}),"\n",(0,o.jsxs)(n.p,{children:["Extract a public Go SDK from ",(0,o.jsx)(n.code,{children:"internal/client/"})," so that developers can\nprogrammatically automate system management without going through the CLI. The\nSDK would be the foundation layer that both the CLI and declarative automation\ntools build on top of."]}),"\n",(0,o.jsx)(n.h2,{id:"motivation",children:"Motivation"}),"\n",(0,o.jsx)(n.p,{children:"Today OSAPI is CLI-driven. A real automation developer would want to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Write Go code that imports an OSAPI SDK package"}),"\n",(0,o.jsx)(n.li,{children:"Define system configurations in YAML/TOML and apply them via the SDK"}),"\n",(0,o.jsx)(n.li,{children:"Build custom automation pipelines (CI/CD, GitOps, fleet management)"}),"\n",(0,o.jsx)(n.li,{children:"Compose operations programmatically (conditionals, loops, error handling)"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"This is the Ansible/Terraform model: SDK at the bottom, CLI and declarative\nconfigs on top."}),"\n",(0,o.jsx)(n.h2,{id:"design-considerations",children:"Design Considerations"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"pkg/sdk/"})})," \u2014 public, importable, semver'd Go module"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Composable primitives"})," \u2014 ",(0,o.jsx)(n.code,{children:"sdk.System.Hostname()"}),", ",(0,o.jsx)(n.code,{children:"sdk.Command.Exec()"}),",\n",(0,o.jsx)(n.code,{children:"sdk.Network.DNS.Get()"}),", etc."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Structured config"})," \u2014 accept Go structs or parse YAML playbooks"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Connection management"})," \u2014 handle auth, retries, timeouts"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"CLI refactor"})," \u2014 rebuild CLI commands on top of the SDK"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Declarative engine"})," \u2014 parse YAML task files, execute steps via SDK (similar\nto Ansible playbooks)"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"example-usage",children:"Example Usage"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'client, _ := sdk.New(sdk.Config{\n    URL:         "http://localhost:8080",\n    BearerToken: os.Getenv("OSAPI_TOKEN"),\n})\n\n// Programmatic usage\nresult, _ := client.Command.Exec(ctx, sdk.ExecParams{\n    Command: "uptime",\n    Target:  "_all",\n})\n\n// Declarative usage\ntasks, _ := sdk.LoadPlaybook("configure.yaml")\nresults := client.Apply(ctx, tasks)\n'})}),"\n",(0,o.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Breaking this out as a separate module (",(0,o.jsx)(n.code,{children:"go.sum"}),"-tracked) enables independent\nversioning"]}),"\n",(0,o.jsxs)(n.li,{children:["Current ",(0,o.jsx)(n.code,{children:"internal/client/"})," can evolve into the SDK with public API surface"]}),"\n",(0,o.jsx)(n.li,{children:"Consider whether the SDK should wrap the REST API or also support direct NATS\ncommunication for lower latency"}),"\n",(0,o.jsx)(n.li,{children:"Playbook format could be inspired by Ansible but simpler"}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453(e,n,t){t.d(n,{R:()=>a,x:()=>r});var o=t(96540);const i={},s=o.createContext(i);function a(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);