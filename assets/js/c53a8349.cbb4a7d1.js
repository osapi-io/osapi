"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5245],{1056(e,n,t){t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var s=t(74848),o=t(28453);const i={title:"CLI taxonomy reorganization",status:"done",created:new Date("2026-02-26T00:00:00.000Z"),updated:new Date("2026-02-26T00:00:00.000Z"),completed:new Date("2026-02-26T00:00:00.000Z")},l=void 0,a={id:"sidebar/development/tasks/done/2026-02-26-cli-taxonomy-reorganization",title:"CLI taxonomy reorganization",description:"Objective",source:"@site/docs/sidebar/development/tasks/done/2026-02-26-cli-taxonomy-reorganization.md",sourceDirName:"sidebar/development/tasks/done",slug:"/sidebar/development/tasks/done/2026-02-26-cli-taxonomy-reorganization",permalink:"/osapi/sidebar/development/tasks/done/2026-02-26-cli-taxonomy-reorganization",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"CLI taxonomy reorganization",status:"done",created:"2026-02-26T00:00:00.000Z",updated:"2026-02-26T00:00:00.000Z",completed:"2026-02-26T00:00:00.000Z"},sidebar:"testSidebar",previous:{title:"Add `changed` field to mutation responses",permalink:"/osapi/sidebar/development/tasks/done/2026-02-25-add-changed-field-to-mutation-responses"},next:{title:"Replace box-drawing tables with compact kubectl-style columns",permalink:"/osapi/sidebar/development/tasks/done/2026-02-26-refactor-compact-table-output"}},r={},d=[{value:"Objective",id:"objective",level:2},{value:"Current State",id:"current-state",level:2},{value:"Problems",id:"problems",level:2},{value:"Ideas to Discuss",id:"ideas-to-discuss",level:2},{value:"Option A: Introduce <code>node</code> as a top-level concept",id:"option-a-introduce-node-as-a-top-level-concept",level:3},{value:"Option B: Rename <code>job agents</code> to something better, keep structure",id:"option-b-rename-job-agents-to-something-better-keep-structure",level:3},{value:"Option C: Merge health + fleet into a single operational view",id:"option-c-merge-health--fleet-into-a-single-operational-view",level:3},{value:"Open Questions",id:"open-questions",level:3},{value:"Notes",id:"notes",level:2}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"objective",children:"Objective"}),"\n",(0,s.jsxs)(n.p,{children:["Rethink the CLI command hierarchy to better reflect operational mental models.\nThe current structure mixes concerns \u2014 agents live under ",(0,s.jsx)(n.code,{children:"job"}),", fleet-wide\nsystem info is under ",(0,s.jsx)(n.code,{children:"system"}),", and ",(0,s.jsx)(n.code,{children:"health"}),' is ambiguous between control-plane\nhealth and fleet health. Drawing parallels to Kubernetes (nodes, pods, kubelet),\nthe CLI should make it obvious where to look when you want to answer: "is my\nfleet healthy and what\'s out there?"']}),"\n",(0,s.jsx)(n.h2,{id:"current-state",children:"Current State"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"osapi client\n\u251c\u2500\u2500 health\n\u2502   \u251c\u2500\u2500 liveness     # API server liveness probe\n\u2502   \u251c\u2500\u2500 ready        # API server readiness probe\n\u2502   \u2514\u2500\u2500 status       # API server + NATS component health\n\u251c\u2500\u2500 system\n\u2502   \u251c\u2500\u2500 hostname     # Get hostname (via job broadcast)\n\u2502   \u251c\u2500\u2500 status       # OS-level info: load, memory, disks, uptime\n\u2502   \u251c\u2500\u2500 exec         # Run a command on target(s)\n\u2502   \u2514\u2500\u2500 shell        # Run a shell command on target(s)\n\u251c\u2500\u2500 job\n\u2502   \u251c\u2500\u2500 add / get / list / run / status\n\u2502   \u2514\u2500\u2500 agents\n\u2502       \u2514\u2500\u2500 list     # Discover active agents (hostname only)\n\u251c\u2500\u2500 network\n\u2502   \u251c\u2500\u2500 dns (get/update)\n\u2502   \u2514\u2500\u2500 ping\n\u251c\u2500\u2500 audit (list/get/export)\n\u2514\u2500\u2500 metrics\n"})}),"\n",(0,s.jsx)(n.h2,{id:"problems",children:"Problems"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"job agents list"})})," is the fleet discovery command but it's buried under\n",(0,s.jsx)(n.code,{children:"job"}),". Agents aren't a sub-concept of jobs \u2014 they're the fleet. Like\n",(0,s.jsx)(n.code,{children:"kubectl get nodes"})," vs ",(0,s.jsx)(n.code,{children:"kubectl get jobs"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Agents only show hostname"})," \u2014 no labels, no status, no uptime. With the new\nheartbeat registry (KV-based), we have richer data available."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.code,{children:"health"})," is ambiguous"]}),' \u2014 it shows API server + NATS infrastructure health,\nbut at the top level it reads like "is my fleet healthy?" It\'s really a\ncontrol-plane operational endpoint (like ',(0,s.jsx)(n.code,{children:"/healthz"})," on the Kubernetes API\nserver)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"system hostname"})})," is mostly redundant now that ",(0,s.jsx)(n.code,{children:"system status"})," includes\nhostname and ",(0,s.jsx)(n.code,{children:"exec"})," exists. May have been useful early on but doesn't carry\nits weight."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'No single "operational dashboard"'}),' \u2014 if you want to know "is everything\nworking?", there\'s no obvious place to start.']}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ideas-to-discuss",children:"Ideas to Discuss"}),"\n",(0,s.jsxs)(n.h3,{id:"option-a-introduce-node-as-a-top-level-concept",children:["Option A: Introduce ",(0,s.jsx)(n.code,{children:"node"})," as a top-level concept"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"osapi client\n\u251c\u2500\u2500 node\n\u2502   \u251c\u2500\u2500 list         # Fleet view: hostname, labels, status, uptime\n\u2502   \u2514\u2500\u2500 status       # Detailed single-node view (what system status does)\n\u251c\u2500\u2500 system\n\u2502   \u251c\u2500\u2500 exec\n\u2502   \u2514\u2500\u2500 shell\n\u251c\u2500\u2500 health           # Stays, but clearly scoped as control-plane health\n\u2502   \u251c\u2500\u2500 liveness\n\u2502   \u251c\u2500\u2500 ready\n\u2502   \u2514\u2500\u2500 status       # API server + NATS internals\n\u251c\u2500\u2500 job (unchanged)\n\u251c\u2500\u2500 network (unchanged)\n\u251c\u2500\u2500 audit (unchanged)\n\u2514\u2500\u2500 metrics\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"node list"})," becomes ",(0,s.jsx)(n.code,{children:"kubectl get nodes"})," \u2014 shows all agents with hostname,\nlabels, status (from the heartbeat registry)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"node status <hostname>"})," shows the detailed OS view (load, memory, disks) \u2014\nwhat ",(0,s.jsx)(n.code,{children:"system status"})," does today"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"system"})," shrinks to just exec/shell (remote execution)"]}),"\n",(0,s.jsx)(n.li,{children:'Agents get a better name ("nodes"? something else?)'}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"option-b-rename-job-agents-to-something-better-keep-structure",children:["Option B: Rename ",(0,s.jsx)(n.code,{children:"job agents"})," to something better, keep structure"]}),"\n",(0,s.jsx)(n.p,{children:"Less disruptive \u2014 just promote agents to top-level and add labels:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"osapi client\n\u251c\u2500\u2500 fleet\n\u2502   \u2514\u2500\u2500 list         # Agents with labels, status\n\u251c\u2500\u2500 system (unchanged)\n\u251c\u2500\u2500 health (unchanged)\n...\n"})}),"\n",(0,s.jsx)(n.h3,{id:"option-c-merge-health--fleet-into-a-single-operational-view",children:"Option C: Merge health + fleet into a single operational view"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"osapi client status   # One-stop: API health + agent fleet + job summary\n"})}),"\n",(0,s.jsx)(n.h3,{id:"open-questions",children:"Open Questions"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["What's the right name? ",(0,s.jsx)(n.code,{children:"node"}),", ",(0,s.jsx)(n.code,{children:"agent"}),", ",(0,s.jsx)(n.code,{children:"fleet"}),", ",(0,s.jsx)(n.code,{children:"host"}),', something creative\nlike Kubernetes did with "kubelet"?']}),"\n",(0,s.jsxs)(n.li,{children:["Should ",(0,s.jsx)(n.code,{children:"system hostname"})," be deprecated/removed?"]}),"\n",(0,s.jsxs)(n.li,{children:["Should ",(0,s.jsx)(n.code,{children:"system status"}),' move under the new concept (it\'s really "tell me about\nthis node")?']}),"\n",(0,s.jsxs)(n.li,{children:["Should ",(0,s.jsx)(n.code,{children:"health status"})," absorb agent fleet info, or stay purely control-plane?"]}),"\n",(0,s.jsx)(n.li,{children:"How does the agent list output change? Add columns: HOSTNAME, LABELS, STATUS,\nUPTIME, LAST SEEN?"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The agent heartbeat registry feature is in progress \u2014 agents now register in a\nKV bucket with hostname + labels + timestamp. This enables richer ",(0,s.jsx)(n.code,{children:"list"}),"\noutput without broadcasting."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"changed"})," field was added to mutation CLI output in #188 but the CLI docs\n(dns/update, exec, shell) were not updated."]}),"\n",(0,s.jsxs)(n.li,{children:["Labels are already configured on agents via ",(0,s.jsx)(n.code,{children:"node.agent.labels"})," in\n",(0,s.jsx)(n.code,{children:"osapi.yaml"})," and stored in the registry. They just aren't surfaced in the CLI\noutput yet."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453(e,n,t){t.d(n,{R:()=>l,x:()=>a});var s=t(96540);const o={},i=s.createContext(o);function l(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);