"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9581],{66344(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var t=s(74848),i=s(28453);const r={title:"Evaluate synadia-io/orbit.go for NATS integration",status:"done",created:new Date("2026-02-17T00:00:00.000Z"),updated:new Date("2026-02-18T00:00:00.000Z")},o=void 0,l={id:"sidebar/development/tasks/done/2026-02-17-chore-evaluate-orbit-go",title:"Evaluate synadia-io/orbit.go for NATS integration",description:"Objective",source:"@site/docs/sidebar/development/tasks/done/2026-02-17-chore-evaluate-orbit-go.md",sourceDirName:"sidebar/development/tasks/done",slug:"/sidebar/development/tasks/done/2026-02-17-chore-evaluate-orbit-go",permalink:"/osapi/sidebar/development/tasks/done/2026-02-17-chore-evaluate-orbit-go",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Evaluate synadia-io/orbit.go for NATS integration",status:"done",created:"2026-02-17T00:00:00.000Z",updated:"2026-02-18T00:00:00.000Z"},sidebar:"testSidebar",previous:{title:"Add Darwin development providers",permalink:"/osapi/sidebar/development/tasks/done/2026-02-16-feat-darwin-providers"},next:{title:"Add AI policy to the project",permalink:"/osapi/sidebar/development/tasks/done/2026-02-17-docs-add-ai-policy"}},a={},c=[{value:"Objective",id:"objective",level:2},{value:"Evaluation",id:"evaluation",level:2},{value:"orbit.go Overview",id:"orbitgo-overview",level:3},{value:"Module-by-Module Assessment",id:"module-by-module-assessment",level:3},{value:"jetstreamext \u2014 JetStream Extensions (HIGH relevance)",id:"jetstreamext--jetstream-extensions-high-relevance",level:4},{value:"kvcodec \u2014 KV Codecs (MODERATE-HIGH relevance)",id:"kvcodec--kv-codecs-moderate-high-relevance",level:4},{value:"natsext \u2014 Core NATS Extensions (MODERATE-HIGH relevance)",id:"natsext--core-nats-extensions-moderate-high-relevance",level:4},{value:"pcgroups \u2014 Partitioned Consumer Groups (MODERATE relevance)",id:"pcgroups--partitioned-consumer-groups-moderate-relevance",level:4},{value:"natssysclient \u2014 NATS System Client (LOW-MODERATE relevance)",id:"natssysclient--nats-system-client-low-moderate-relevance",level:4},{value:"counters \u2014 Distributed Counters (LOW-MODERATE relevance)",id:"counters--distributed-counters-low-moderate-relevance",level:4},{value:"natscontext \u2014 NATS Context (LOW relevance)",id:"natscontext--nats-context-low-relevance",level:4},{value:"Comparison with Current nats-client",id:"comparison-with-current-nats-client",level:3},{value:"Maturity &amp; Risk",id:"maturity--risk",level:3},{value:"Recommendation: Skip (revisit when modules hit v1.0)",id:"recommendation-skip-revisit-when-modules-hit-v10",level:2},{value:"Outcome",id:"outcome",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"objective",children:"Objective"}),"\n",(0,t.jsxs)(n.p,{children:["Evaluate whether ",(0,t.jsx)(n.a,{href:"https://github.com/synadia-io/orbit.go",children:"https://github.com/synadia-io/orbit.go"})," would be a good fit for\nOSAPI's NATS JetStream integration, potentially replacing or complementing the\ncurrent nats-client sibling repo."]}),"\n",(0,t.jsx)(n.h2,{id:"evaluation",children:"Evaluation"}),"\n",(0,t.jsx)(n.h3,{id:"orbitgo-overview",children:"orbit.go Overview"}),"\n",(0,t.jsxs)(n.p,{children:["orbit.go is a collection of ",(0,t.jsx)(n.strong,{children:"independent Go modules"})," (separate ",(0,t.jsx)(n.code,{children:"go.mod"})," each)\nfrom Synadia that provide higher-level abstractions over the NATS Go client. All\nmodules are ",(0,t.jsx)(n.strong,{children:"pre-v1.0"})," with no API stability guarantees. The repo has 68\nstars, 8 contributors, and active development (11 releases as of Feb 2026)."]}),"\n",(0,t.jsx)(n.h3,{id:"module-by-module-assessment",children:"Module-by-Module Assessment"}),"\n",(0,t.jsx)(n.h4,{id:"jetstreamext--jetstream-extensions-high-relevance",children:"jetstreamext \u2014 JetStream Extensions (HIGH relevance)"}),"\n",(0,t.jsxs)(n.p,{children:["Provides ",(0,t.jsx)(n.code,{children:"GetBatch"})," (fetch N messages from a stream by subject/sequence/ time)\nand ",(0,t.jsx)(n.code,{children:"GetLastMsgsFor"})," (get last message for each of N subjects). Also adds atomic\n",(0,t.jsx)(n.code,{children:"PublishMsgBatch"})," for all-or-nothing multi-message publishing."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"GetBatch"})," could improve job listing by fetching stream messages with subject\nfilters instead of scanning all KV keys."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"GetLastMsgsFor"}),' maps directly to "get latest status event per job" queries.']}),"\n",(0,t.jsx)(n.li,{children:"Batch publish enables atomic multi-job creation if needed later."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Caveat:"})," Batch publish requires nats-server v2.12.0+. Requires Go 1.24+\n(OSAPI uses 1.25, so fine)."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"kvcodec--kv-codecs-moderate-high-relevance",children:"kvcodec \u2014 KV Codecs (MODERATE-HIGH relevance)"}),"\n",(0,t.jsxs)(n.p,{children:["Wraps ",(0,t.jsx)(n.code,{children:"jetstream.KeyValue"})," to transparently encode/decode keys and values.\nIncludes ",(0,t.jsx)(n.code,{children:"Base64Codec"})," and ",(0,t.jsx)(n.code,{children:"PathCodec"})," (converts ",(0,t.jsx)(n.code,{children:"/"})," paths to ",(0,t.jsx)(n.code,{children:"."})," NATS\nsubjects). Implements the full ",(0,t.jsx)(n.code,{children:"jetstream.KeyValue"})," interface \u2014 drop-in wrapper."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["OSAPI already solved the dotted-hostname problem by sanitizing dots in\n",(0,t.jsx)(n.code,{children:"BuildSubjectFromTarget"}),". kvcodec would be a cleaner, more general solution."]}),"\n",(0,t.jsx)(n.li,{children:"Zero changes to existing KV operations \u2014 just wrap the bucket."}),"\n",(0,t.jsx)(n.li,{children:"Useful insurance against future key-encoding edge cases with labels or\nhostnames."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"natsext--core-nats-extensions-moderate-high-relevance",children:"natsext \u2014 Core NATS Extensions (MODERATE-HIGH relevance)"}),"\n",(0,t.jsxs)(n.p,{children:["Adds ",(0,t.jsx)(n.code,{children:"RequestMany"})," / ",(0,t.jsx)(n.code,{children:"RequestManyMsg"})," for scatter-gather patterns: send one\nrequest, collect multiple replies with stall timers, max message caps, and\nsentinel detection."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["OSAPI's broadcast response collection currently uses KV watch + quiet period\npolling (3-second silence window). ",(0,t.jsx)(n.code,{children:"RequestMany"})," would enable real-time\nscatter-gather without the KV intermediary."]}),"\n",(0,t.jsx)(n.li,{children:'Most useful if OSAPI adds a synchronous "query all workers and aggregate in\nreal time" mode.'}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"pcgroups--partitioned-consumer-groups-moderate-relevance",children:"pcgroups \u2014 Partitioned Consumer Groups (MODERATE relevance)"}),"\n",(0,t.jsx)(n.p,{children:"Partitions messages by key so same-key messages always go to the same consumer,\nwhile different keys process in parallel. Both static and elastic (dynamic\nmembership) modes."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["OSAPI's current queue group model works well for ",(0,t.jsx)(n.code,{children:"_any"}),' routing. PCGroups\nwould matter if we needed per-resource ordering guarantees (e.g., "all DNS\nupdates for eth0 go to the same worker to avoid conflicts").']}),"\n",(0,t.jsx)(n.li,{children:"Requires nats-server 2.11+."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"natssysclient--nats-system-client-low-moderate-relevance",children:"natssysclient \u2014 NATS System Client (LOW-MODERATE relevance)"}),"\n",(0,t.jsxs)(n.p,{children:["Type-safe access to NATS monitoring APIs (",(0,t.jsx)(n.code,{children:"varz"}),", ",(0,t.jsx)(n.code,{children:"connz"}),", ",(0,t.jsx)(n.code,{children:"jsz"}),", ",(0,t.jsx)(n.code,{children:"healthz"}),",\netc.) with single-server and cluster-wide scatter-gather."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Useful for observability dashboards but not for core job processing."}),"\n",(0,t.jsx)(n.li,{children:"Could complement a future monitoring/health feature."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"counters--distributed-counters-low-moderate-relevance",children:"counters \u2014 Distributed Counters (LOW-MODERATE relevance)"}),"\n",(0,t.jsx)(n.p,{children:"Arbitrary-precision distributed counters backed by JetStream streams."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'Could track "total jobs processed per worker" or "failures per host" without a\nseparate metrics database.'}),"\n",(0,t.jsx)(n.li,{children:"OSAPI computes queue stats by scanning KV keys today, which works fine."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"natscontext--nats-context-low-relevance",children:"natscontext \u2014 NATS Context (LOW relevance)"}),"\n",(0,t.jsxs)(n.p,{children:["Connects using NATS CLI saved context profiles. OSAPI manages its own\nconnections through ",(0,t.jsx)(n.code,{children:"osapi.yaml"})," / Viper. Not applicable."]}),"\n",(0,t.jsx)(n.h3,{id:"comparison-with-current-nats-client",children:"Comparison with Current nats-client"}),"\n",(0,t.jsxs)(n.p,{children:["OSAPI wraps ",(0,t.jsx)(n.code,{children:"github.com/osapi-io/nats-client"})," behind a ",(0,t.jsx)(n.code,{children:"messaging.NATSClient"}),"\ninterface with methods for: ",(0,t.jsx)(n.code,{children:"Connect"}),", ",(0,t.jsx)(n.code,{children:"CreateOrUpdateStreamWithConfig"}),",\n",(0,t.jsx)(n.code,{children:"CreateOrUpdateConsumerWithConfig"}),", ",(0,t.jsx)(n.code,{children:"CreateKVBucket"}),", ",(0,t.jsx)(n.code,{children:"KVPut/Get/Delete/Keys"}),",\n",(0,t.jsx)(n.code,{children:"Publish"}),", ",(0,t.jsx)(n.code,{children:"PublishAndWaitKV"}),", ",(0,t.jsx)(n.code,{children:"ConsumeMessages"}),", ",(0,t.jsx)(n.code,{children:"GetStreamInfo"}),"."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Concern"}),(0,t.jsx)(n.th,{children:"nats-client"}),(0,t.jsx)(n.th,{children:"orbit.go"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Scope"})}),(0,t.jsx)(n.td,{children:"Full NATS abstraction (connect, streams, KV, consumers, publish, consume)"}),(0,t.jsx)(n.td,{children:"Individual utilities that enhance specific patterns"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Architecture"})}),(0,t.jsx)(n.td,{children:"Single wrapper with unified interface"}),(0,t.jsx)(n.td,{children:"Independent modules, each solving one problem"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Replaceability"})}),(0,t.jsx)(n.td,{children:"orbit.go cannot replace nats-client \u2014 it has no connection management, stream/consumer creation, or basic KV CRUD"}),(0,t.jsx)(n.td,{children:"orbit.go modules layer on top of raw nats.go, same level as nats-client"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Testing"})}),(0,t.jsxs)(n.td,{children:["OSAPI mocks ",(0,t.jsx)(n.code,{children:"messaging.NATSClient"})," for all tests"]}),(0,t.jsx)(n.td,{children:"Each orbit module is independently testable"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Key insight:"})," orbit.go is not a replacement for nats-client. It's a\ncollection of enhancements that could complement either nats-client or raw\nnats.go usage."]}),"\n",(0,t.jsx)(n.h3,{id:"maturity--risk",children:"Maturity & Risk"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All modules are pre-v1.0 \u2014 APIs may break between releases."}),"\n",(0,t.jsx)(n.li,{children:"Small community (68 stars, 8 contributors)."}),"\n",(0,t.jsx)(n.li,{children:"Backed by Synadia (the company behind NATS), so unlikely to be abandoned, but\nmay evolve rapidly."}),"\n",(0,t.jsx)(n.li,{children:"Some modules require very recent nats-server versions (2.11+, 2.12+)."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"recommendation-skip-revisit-when-modules-hit-v10",children:"Recommendation: Skip (revisit when modules hit v1.0)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Do not adopt orbit.go modules now."})," The risk/reward doesn't justify it:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"nats-client works well."})," OSAPI's current abstraction covers all needs. The\n",(0,t.jsx)(n.code,{children:"messaging.NATSClient"})," interface is clean and testable."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Pre-v1.0 instability."})," Adopting pre-v1.0 modules means accepting breaking\nchanges on every upgrade. OSAPI's NATS integration is foundational \u2014\ninstability here is costly."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"No critical gap."})," The most relevant modules (jetstreamext, kvcodec,\nnatsext) solve optimization problems, not missing functionality. OSAPI's\nKV-scan approach works, the dot-sanitization fix works, and KV watch polling\nworks."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Dependency weight."})," Each orbit module pulls its own dependency tree.\nAdding multiple modules increases maintenance surface for marginal gains."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When to revisit:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["When ",(0,t.jsx)(n.code,{children:"jetstreamext"})," or ",(0,t.jsx)(n.code,{children:"kvcodec"})," reach v1.0 \u2014 these are the most useful\nmodules and stable APIs would make adoption worthwhile."]}),"\n",(0,t.jsxs)(n.li,{children:["If KV-scan performance becomes a bottleneck at scale \u2014 ",(0,t.jsx)(n.code,{children:"GetBatch"})," and\n",(0,t.jsx)(n.code,{children:"GetLastMsgsFor"})," would be the right solution."]}),"\n",(0,t.jsxs)(n.li,{children:["If OSAPI adds real-time scatter-gather queries \u2014 ",(0,t.jsx)(n.code,{children:"RequestMany"})," from natsext\nwould be cleaner than the current KV watch approach."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"outcome",children:"Outcome"}),"\n",(0,t.jsxs)(n.p,{children:["Completed evaluation. Recommendation is ",(0,t.jsx)(n.strong,{children:"skip for now"})," \u2014 orbit.go modules are\ninteresting but pre-v1.0 and solve optimization problems rather than missing\nfunctionality. The most relevant modules (jetstreamext, kvcodec, natsext) should\nbe revisited when they stabilize."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453(e,n,s){s.d(n,{R:()=>o,x:()=>l});var t=s(96540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);