"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[2699],{83512(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=n(74848),a=n(28453);const r={title:"Enhance health status with agents and consumers",status:"backlog",created:new Date("2026-02-26T00:00:00.000Z"),updated:new Date("2026-02-26T00:00:00.000Z")},i=void 0,o={id:"sidebar/development/tasks/backlog/2026-02-26-feat-health-status-enhancements",title:"Enhance health status with agents and consumers",description:"Objective",source:"@site/docs/sidebar/development/tasks/backlog/2026-02-26-feat-health-status-enhancements.md",sourceDirName:"sidebar/development/tasks/backlog",slug:"/sidebar/development/tasks/backlog/2026-02-26-feat-health-status-enhancements",permalink:"/osapi/sidebar/development/tasks/backlog/2026-02-26-feat-health-status-enhancements",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Enhance health status with agents and consumers",status:"backlog",created:"2026-02-26T00:00:00.000Z",updated:"2026-02-26T00:00:00.000Z"},sidebar:"testSidebar",previous:{title:"Extract GitHub org config into dedicated repo",permalink:"/osapi/sidebar/development/tasks/backlog/2026-02-25-github-org-config-repo"},next:{title:"Kubernetes and systemd inspired patterns",permalink:"/osapi/sidebar/development/tasks/backlog/2026-02-26-kubernetes-systemd-patterns"}},c={},d=[{value:"Objective",id:"objective",level:2},{value:"Changes",id:"changes",level:2},{value:"Show registered agents",id:"show-registered-agents",level:3},{value:"Show registry bucket in KV Buckets table",id:"show-registry-bucket-in-kv-buckets-table",level:3},{value:"Show consumers (stretch)",id:"show-consumers-stretch",level:3},{value:"Notes",id:"notes",level:2}];function l(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"objective",children:"Objective"}),"\n",(0,s.jsxs)(t.p,{children:["Enrich the ",(0,s.jsx)(t.code,{children:"client health status"})," output with agent registry and consumer\ninformation so operators get a complete operational overview from a single\ncommand."]}),"\n",(0,s.jsx)(t.h2,{id:"changes",children:"Changes"}),"\n",(0,s.jsx)(t.h3,{id:"show-registered-agents",children:"Show registered agents"}),"\n",(0,s.jsxs)(t.p,{children:["Read the ",(0,s.jsx)(t.code,{children:"agent-registry"})," KV bucket and display an Agents section:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"  Agents: 3 registered\n  \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n  \u2503 HOSTNAME                  \u2503 LABELS          \u2503 REGISTERED \u2503\n  \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n  \u2503 web-01                    \u2503 group=web.prod  \u2503 15s ago    \u2503\n  \u2503 web-02                    \u2503 group=web.prod  \u2503 8s ago     \u2503\n  \u2503 db-01                     \u2503 group=db        \u2503 2m ago     \u2503\n  \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u253b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u253b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The registry KV bucket uses a 30s TTL, so only live agents appear. The\n",(0,s.jsx)(t.code,{children:"REGISTERED"})," column shows the age of ",(0,s.jsx)(t.code,{children:"registered_at"})," from the\n",(0,s.jsx)(t.code,{children:"AgentRegistration"})," entry."]}),"\n",(0,s.jsx)(t.h3,{id:"show-registry-bucket-in-kv-buckets-table",children:"Show registry bucket in KV Buckets table"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"agent-registry"})," bucket should appear alongside ",(0,s.jsx)(t.code,{children:"job-queue"})," in the existing\nKV Buckets table. Investigate why it currently does not \u2014 the health endpoint\nmay be filtering to specific bucket names rather than listing all buckets."]}),"\n",(0,s.jsx)(t.h3,{id:"show-consumers-stretch",children:"Show consumers (stretch)"}),"\n",(0,s.jsx)(t.p,{children:"Add a Consumers section showing JetStream consumer details per stream. This\nwould help operators see which agents have active subscriptions and whether\nconsumers are lagging:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"  Consumers (osapi-JOBS):\n  \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n  \u2503 NAME                      \u2503 PENDING  \u2503 ACKED   \u2503\n  \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u254b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252b\n  \u2503 query_any_web_01          \u2503 0        \u2503 142     \u2503\n  \u2503 query_direct_web_01       \u2503 0        \u2503 38      \u2503\n  \u2503 modify_any_web_01         \u2503 1        \u2503 15      \u2503\n  \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u253b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u253b\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n"})}),"\n",(0,s.jsx)(t.p,{children:"This is lower priority \u2014 the agent list covers the main operational need.\nConsumer details are useful for debugging but may be noisy with many agents."}),"\n",(0,s.jsx)(t.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The health status API response schema will need new fields for agents and\noptionally consumers"}),"\n",(0,s.jsx)(t.li,{children:"The SDK and CLI will need updates to render the new sections"}),"\n",(0,s.jsxs)(t.li,{children:["Consider adding a ",(0,s.jsx)(t.code,{children:"--verbose"})," flag to show consumers only when requested"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453(e,t,n){n.d(t,{R:()=>i,x:()=>o});var s=n(96540);const a={},r=s.createContext(a);function i(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);