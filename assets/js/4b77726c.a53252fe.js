"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5289],{17188(e,t,s){s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var n=s(74848),i=s(28453);const r={title:"Port system API to use job client",status:"done",created:new Date("2026-02-15T00:00:00.000Z"),updated:new Date("2026-02-15T00:00:00.000Z")},o=void 0,l={id:"sidebar/development/tasks/done/2026-02-15-refactor-system-api-job-client",title:"Port system API to use job client",description:"Objective",source:"@site/docs/sidebar/development/tasks/done/2026-02-15-refactor-system-api-job-client.md",sourceDirName:"sidebar/development/tasks/done",slug:"/sidebar/development/tasks/done/2026-02-15-refactor-system-api-job-client",permalink:"/osapi/sidebar/development/tasks/done/2026-02-15-refactor-system-api-job-client",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Port system API to use job client",status:"done",created:"2026-02-15T00:00:00.000Z",updated:"2026-02-15T00:00:00.000Z"},sidebar:"testSidebar",previous:{title:"Standardize server/worker CLI lifecycle and context handling",permalink:"/osapi/sidebar/development/tasks/done/2026-02-15-refactor-server-lifecycle-consistency"},next:{title:"Consistency pass and test coverage audit",permalink:"/osapi/sidebar/development/tasks/done/2026-02-15-test-consistency-audit"}},a={},c=[{value:"Objective",id:"objective",level:2},{value:"Changes",id:"changes",level:2},{value:"Tests",id:"tests",level:2},{value:"Verify",id:"verify",level:2}];function d(e){const t={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"objective",children:"Objective"}),"\n",(0,n.jsx)(t.p,{children:"Replace direct provider calls in system API handlers with JobClient calls so\nrequests route through NATS. System API already uses strict-server."}),"\n",(0,n.jsx)(t.h2,{id:"changes",children:"Changes"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/system/types.go"}),": Replace providers with JobClient"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/system/system.go"}),": Update factory"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/system/system_hostname_get.go"}),": Use JobClient"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/system/system_status_get.go"}),": Use JobClient"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/handler_system.go"}),": Remove provider construction"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/handler.go"}),": Add jobClient parameter"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"internal/api/manager.go"}),": Update interface"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"cmd/api_server_start.go"}),": Wire up job client"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"tests",children:"Tests"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"system_hostname_get_test.go"})," (new internal test)"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"system_status_get_public_test.go"})," (new)"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"verify",children:"Verify"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"go build ./...\ngo test -v ./internal/api/system/...\ngo test -cover ./internal/api/system/...\n"})})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453(e,t,s){s.d(t,{R:()=>o,x:()=>l});var n=s(96540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);